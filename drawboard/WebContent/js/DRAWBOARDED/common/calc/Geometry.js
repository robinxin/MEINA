/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["common.calc.Geometry"]){dojo._hasResource["common.calc.Geometry"]=true;dojo.provide("common.calc.Geometry");dojo.require("common.calc.Math");dojo.require("common.utils.CollectionUtils");(function(){var _1=common.calc.Math,_2=common.utils.CollectionUtils;common.calc.Geometry={add2Points:function(p1,p2){return {x:p1.x+p2.x,y:p1.y+p2.y};},subtract2Points:function(p1,p2){return {x:p1.x-p2.x,y:p1.y-p2.y};},multiPoint:function(p1,_3){var np=[],_4=_2.copy4Attrs,_5;(!dojo.isArray(p1))&&(p1=[p1]);dojo.forEach(p1,function(_6){_5={x:_6.x*_3.x,y:_6.y*_3.y};_4(_6,_5,{x:1,y:1});np.push(_5);},this);return np;},dividePoint:function(p1,_7){var np=[],_8=_2.copy4Attrs,_9;(!dojo.isArray(p1))&&(p1=[p1]);dojo.forEach(p1,function(_a){_9={x:_a.x/_7.x,y:_a.y/_7.y};_8(_a,_9,{x:1,y:1});np.push(_9);},this);return np;},getDistant:function(p1,p2){if(p1.x==p2.x){return Math.abs(p2.y-p1.y);}if(p1.y==p2.y){return Math.abs(p2.x-p1.x);}return Math.sqrt(Math.pow((p1.x-p2.x),2)+Math.pow((p1.y-p2.y),2));},equals4Ps:function(p1,p2){if(p1.x==p2.x&&p1.y==p2.y){return true;}return false;},getExtremePoints:function(_b){var _c,_d,_e,_f;dojo.forEach(_b,function(_10){dojo.forEach(_10,function(ps){if(_c===undefined){_c=_e=ps.x;_d=_f=ps.y;return;}(ps.x>_c)&&(_c=ps.x);(ps.x<_e)&&(_e=ps.x);(ps.y>_d)&&(_d=ps.y);(ps.y<_f)&&(_f=ps.y);},this);},this);return {minX:_e,maxX:_c,minY:_f,maxY:_d};},getMaxRect:function(_11){var _12,_13,_14,_15;dojo.forEach(_11,function(_16){dojo.forEach(_16,function(ps){if(_12===undefined){_12=_14=ps.x;_13=_15=ps.y;return;}(ps.x>_12)&&(_12=ps.x);(ps.x<_14)&&(_14=ps.x);(ps.y>_13)&&(_13=ps.y);(ps.y<_15)&&(_15=ps.y);},this);},this);return {x:_14,y:_15,width:_12-_14,height:_13-_15};},angle:function(A,B,C){return this.rad(A,B,C)*57.29577951308232;},rad:function(A,B,C){var ax=A.x,ay=A.y,bx=B.x,by=B.y,cx=C.x,cy=C.y,phi;phi=Math.atan2(cy-by,cx-bx)-Math.atan2(ay-by,ax-bx);if(phi<0){phi+=6.283185307179586;}return phi;},rotation:function(_17,_18,_19){var x0=_17.x-_18.x,y0=_17.y-_18.y,_19=3.1415916*_19/180,c=Math.cos(_19),s=Math.sin(_19),x1=x0*c-y0*s+_18.x,y1=x0*s+y0*c+_18.y;return {x:x1,y:y1};},isPointInRect:function(q1,q2,p){var min=Math.min,max=Math.max;if(min(q1.x,q2.x)<=p.x&&p.x<=max(q1.x,q2.x)&&min(q1.y,q2.y)<=p.y&&p.y<=max(q1.y,q2.y)){return true;}return false;if(coordinate.x<rect.coordinate.x||coordinate.y<rect.coordinate.y||coordinate.x>rect.coordinate.x+rect.w||coordinate.y>rect.coordinate.y+rect.h){return false;}return true;},isPointInCircle:function(_1a,_1b){var _1c=this.getDistant(_1a,_1b.coordinate);if(_1c<=_1b.r){return true;}return false;},isPointInSegment:function(q1,q2,p){if(_1.cross(q1,q2,p)!=0){return false;}return this.isPointInRect(q1,q2,p);},isPointInPolyn:function(_1d,pt){for(var c=false,i=-1,l=_1d.length,j=l-1;++i<l;j=i){((_1d[i].y<=pt.y&&pt.y<_1d[j].y)||(_1d[j].y<=pt.y&&pt.y<_1d[i].y))&&(pt.x<(_1d[j].x-_1d[i].x)*(pt.y-_1d[i].y)/(_1d[j].y-_1d[i].y)+_1d[i].x)&&(c=!c);}return c;},graphContainsGraph:function(_1e,_1f){var _20=this.getExtremePoints(_1e),_21=this.getExtremePoints(_1f);if(_20.minX>_21.minX&&_20.minY>_21.minY&&_20.maxX<_21.maxX&&_20.maxY<_21.maxY){return true;}return false;},intersectRectRect:function(_22,_23){var _24=_22.x,_25=_22.y,_26=_24+_22.width,_27=_25+_22.height,_28=_23.x,_29=_23.y,_2a=_28+_23.width,_2b=_29+_23.height;if(_26==undefined||_27==undefined||_2a==undefined||_2b==undefined){return false;}var xs=(_24>_26)?{min:_26,max:_24}:{min:_24,max:_26},ys=(_25>_27)?{min:_27,max:_25}:{min:_25,max:_27},_2c=(_28>_2a)?{min:_2a,max:_28}:{min:_28,max:_2a},_2d=(_29>_2b)?{min:_2b,max:_29}:{min:_29,max:_2b};if(xs.min>_2c.max||ys.min>_2d.max||xs.max<_2c.min||ys.max<_2d.min){return false;}return true;},intersectLineLine:function(_2e,_2f){var A=_2e.x,B=_2e.y,C=_2f.x,D=_2f.y,d0,d1,den,x,y;d0=A[1]*B[2]-A[2]*B[1];d1=C[1]*D[2]-C[2]*D[1];den=(B[2]-A[2])*(C[1]-D[1])-(A[1]-B[1])*(D[2]-C[2]);if(Math.abs(den)<Math.E){den=Math.E;}x=(d0*(C[1]-D[1])-d1*(A[1]-B[1]))/den;y=(d1*(B[2]-A[2])-d0*(D[2]-C[2]))/den;return {x:x,y:y};},isHorizontal:function(p1,p2){if(p1.x==p2.x){return true;}return false;},isVertical:function(p1,p2){if(p1.y==p2.y){return true;}return false;},vdistP2Lin:function(c1,c2,c0){var a=180-this.angle(c1,c2,c0),d=this.getDistant(c2,c0);return {x:Math.cos(a)*d,y:Math.sin(a)*d};},distP2Line:function(c1,c2,c0){var _30=0,_31=this.getDistant,a=_31(c1,c2),b=_31(c1,c0),c=_31(c2,c0),p,s;if(c<=0.000001||b<=0.000001){_30=0;return _30;}if(a<=0.000001){_30=b;return _30;}if(c*c>=a*a+b*b){_30=b;return _30;}if(b*b>=a*a+c*c){_30=c;return _30;}p=(a+b+c)>>1;s=Math.sqrt(p*(p-a)*(p-b)*(p-c));_30=2*s/a;return _30;},intersectCircleLine:function(c1,r,l1,l2){var s,d0,d1,b,w,h,r,n1,dx,dy,_32,_33,l,x,y,n1s,_34,_35,d,_36=this.getDistant;s=_36(l1,l2);if(s>0){d0=_36(c1,l1);d1=_36(c1,l2);b=((d0*d0)+(s*s)-(d1*d1))/(2*s);w=(d0*d0)-(b*b);w=(w<0)?0:w;h=Math.sqrt(w);n1=Math.sqrt((r*r)-h*h);dx=l2.x-l1.x;dy=l2.y-l1.y;_32=c1.x+(h/s)*dy;_33=c1.y-(h/s)*dx;d0=(l2.x*dy)-(l2.y*dx);d1=(_32*dx)+(_33*dy);l=(dy*dy)+(dx*dx);if(Math.abs(l)<Math.E){l=Math.E;}x=((d0*dy)+(d1*dx))/l;y=((d1*dy)-(d0*dx))/l;n1s=n1/s;_34={x:x+n1s*dx,y:y+n1s*dy};_35={x:x-n1s*dx,y:y-n1s*dy};d=_36(c1,_34);if((r<(d-1))||isNaN(d)){return [];}else{return [_34,_35];}}return [];}};})();}