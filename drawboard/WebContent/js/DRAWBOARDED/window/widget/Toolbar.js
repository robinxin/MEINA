/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["window.widget.Toolbar"]){dojo._hasResource["window.widget.Toolbar"]=true;dojo.provide("window.widget.Toolbar");dojo.require("dijit._Widget");dojo.require("dijit._Templated");dojo.require("dijit.Toolbar");dojo.require("dijit.form.DropDownButton");dojo.require("dijit.ColorPalette");dojo.require("drawboard.Constant");dojo.require("dijit.Menu");dojo.require("window.widget.TextDialogue");dojo.declare("window.widget.Toolbar",[dijit._Widget,dijit._Templated],{templateString:"<div><span dojoAttachPoint='toolbarContainer'></span></div>",drawboard:null,postCreate:function(){var _1=new dijit.Toolbar({},this.toolbarContainer),_2=this.getDefinition()._arrayOfAllItems[0].children,_3=drawboard.Constant.Toolbar,_4,_5,_6=this,_7,_8;dojo.forEach(_2,function(_9){_5=_9.name[0];_8=dojo.hitch(_6,_9.action[0]);switch(_9.type&&_9.type[0]){case _3.COLORPALETTE:_4=new dijit.form.DropDownButton({label:_5,title:_5,showLabel:true,dropDown:new dijit.ColorPalette({drawboard:_6.drawboard,palette:"7x10",onChange:_8})});break;case _3.DROPDOWNLIST:_7=_9.list;if(!(_7 instanceof Array)){var _a=_7.start,_b=_7.end,_7=[];while(_a<=_b){_7.push(_a);_a++;}}_4=_6.createDropDownList(_7,_6[_9.action[0]],_5);break;case _3.DIALOGUE:_4=new dijit.form.Button({label:_5,showLabel:false,title:_5,iconClass:"dijitEditorIcon dijitEditorIcon toolbarIcon "+_9.css[0],onClick:_8});break;default:_4=new dijit.form.Button({label:_5,showLabel:false,title:_5,iconClass:"dijitEditorIcon dijitEditorIcon toolbarIcon "+_9.css[0],onClick:_8});break;}_4&&_1.addChild(_4);_4=null;});},strokeWidth:function(e){this.toolbar.drawboard.setStyle("stroke-width",this.label);},stroke:function(e){this.drawboard.setStyle("stroke",e);},fill:function(e){this.drawboard.setStyle("fill",e);},combine:function(e){this.drawboard.combine();},divide:function(e){this.drawboard.divide();},next:function(e){this.drawboard.redo();},previous:function(e){this.drawboard.undo();},save:function(e){},text:function(e){var db=this.drawboard;db.setStatus(null,null,drawboard.Constant.ActionStatus.TEXT);},fontColor:function(e){this.drawboard.setStyle("fill",e,true);},fontSize:function(e){this.toolbar.drawboard.setStyle("font-size",this.label+"px",true);},fontFamily:function(e){this.toolbar.drawboard.setStyle("font-family",this.label,true);},showContact:function(e){var _c="QQ:65265800";new window.widget.TextDialogue({text:_c}).show();},createDropDownList:function(_d,_e,_f){var _10=new dijit.Menu({style:"display: none;"}),_11=this;dojo.forEach(_d,function(_12){var _13=new dijit.MenuItem({label:_12,name:_12,onClick:_e,toolbar:_11});_10.addChild(_13);},this);return new dijit.form.DropDownButton({label:_f,dropDown:_10});},createDefinition:function(){this.definition=new dojo.data.ItemFileReadStore({url:drawboardRuntimeSetting.toolbarImgUrl});this.definition._forceLoad();},getDefinition:function(){if(!this.definition){this.createDefinition();}return this.definition;}});}