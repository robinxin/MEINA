/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["drawboard.graph.decorate.controller.SkeletonController"]){dojo._hasResource["drawboard.graph.decorate.controller.SkeletonController"]=true;dojo.provide("drawboard.graph.decorate.controller.SkeletonController");dojo.require("drawboard.graph.decorate.controller.Controller");dojo.require("drawboard.graph.decorate.Skeleton");dojo.require("common.utils.CollectionUtils");dojo.require("common.calc.Geometry");(function(){var _1=common.calc.Geometry,_2=common.utils.CollectionUtils;dojo.declare("drawboard.graph.decorate.controller.SkeletonContainer",drawboard.graph.decorate.controller.Controller,{type:drawboard.Constant.Decorate.SKELETON,draw:function(gp,_3){var _4,_5=new drawboard.graph.decorate.Skeleton(),gf=_3.getGraphic();dojo.forEach(gp.getSkeletonCoordinates(_3)||[],function(_6,_7){_4=_2.sliceRange(_6,1,4);_5.setCoordinate(_4);_5.setIndex(_7);_6[0].isAnchored&&_5.anchored(_6[0].isAnchored);_5.draw(gf,this.getStyle(gp,_5,_3),_3);},this);},isIn:function(ps,_8,_9){return _1.isPointInPolyn(ps,_8);},active:function(gp,_a,_b){var _c,gs=gp.getGraphStrategy(),_d,_e;dojo.some(gp.getSkeletonCoordinates(_b)||[],function(_f,_10){_e=_f[0];_d=_2.sliceRange(_f,1,4);if(this.isIn(_d,_a,_b)){_c=new drawboard.graph.decorate.Skeleton({coordinate:_d,index:_10,_direct:_f[0].css,center:_e});gs.isAnchor(_c)&&_c.anchored(true);return true;}},this);return _c;},create:function(ps){var _11=[];dojo.forEach(ps||[],function(_12,_13){_11.push(this.createItem(_12,_13));},this);return _11;},createItem:function(ps,_14){var _15=new drawboard.graph.decorate.Skeleton({coordinate:_2.sliceRange(ps,1,4),index:_14,_direct:ps[0].css});ps[0].isAnchored&&_15.anchored(true);return _15;}});if(!drawboard.skeletonController){drawboard.skeletonController=new drawboard.graph.decorate.controller.SkeletonContainer();}})();}