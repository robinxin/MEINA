/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["drawboard.graph.decorate.controller.MarkController"]){dojo._hasResource["drawboard.graph.decorate.controller.MarkController"]=true;dojo.provide("drawboard.graph.decorate.controller.MarkController");dojo.require("drawboard.graph.decorate.controller.Controller");dojo.require("drawboard.graph.decorate.Mark");dojo.require("drawboard.Constant");dojo.require("common.calc.Geometry");(function(){var _1=common.calc.Geometry;dojo.declare("drawboard.graph.decorate.controller.MarkController",drawboard.graph.decorate.controller.Controller,{type:drawboard.Constant.Decorate.MARK,draw:function(gp,_2){var _3,_4=new drawboard.graph.decorate.Mark(),gf=_2.getGraphic();dojo.forEach(gp.getMarkCoordinates(_2)||[],function(_5,_6){_3=[_5[1],_5[3],_5[2],_5[4]];_4.setCoordinate(_3);_4.setIndex(_6);_4.draw(gf,this.getStyle(gp,_4,_2),_2);},this);},active:function(gp,_7,_8){var _9;dojo.some(gp.getMarkCoordinates(_8)||[],function(_a,_b){_a=[_a[1],_a[3],_a[2],_a[4]];if(_1.isPointInPolyn(_a,_7)){_9=new drawboard.graph.decorate.Mark({coordinate:_a,index:_b,center:_a[0]});return true;}},this);return _9;},create:function(ps){var _c,_d=[];dojo.forEach(ps||[],function(_e,_f){_c=[_e[1],_e[3],_e[2],_e[4]];_c=new drawboard.graph.decorate.Mark({coordinate:skeleton,index:_f});_d.push(_c);},this);return _d;},cross:function(s,cgp,db,_10){var _11,_12=drawboard.skeletonController,_13,_14={};db.some(function(gp){if(gp==cgp){return false;}_11=gp.getMarkCoordinates(_10);dojo.some(_11||[],function(_15,_16){_15=[_15[1],_15[3],_15[2],_15[4]];dojo.some(_15,function(p){if(_12.isIn(s.getCoordinate(),p,_10)){_13=true;return true;}},this);if(_13){_14.d=new drawboard.graph.decorate.Mark({coordinate:_15,index:_16});return true;}},this);if(_13){_14.gp=gp;return true;}},this,true);if(_13){_14.restrainedGp=cgp;_14.restrainedD=s;return _14;}return null;}});if(!drawboard.markController){drawboard.markController=new drawboard.graph.decorate.controller.MarkController();}})();}