/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["drawboard.graphic.VMLGraphic"]){dojo._hasResource["drawboard.graphic.VMLGraphic"]=true;dojo.provide("drawboard.graphic.VMLGraphic");dojo.require("drawboard.graphic.Graphic");dojo.require("common.utils.BrowerUtils");(function(){var _1=dojo.attr,_2=window.location.pathname,_3=_2.substring(0,_2.indexOf("/",1)+1),_1=function(_4,_5,_6){try{_4[_5]=_6;}catch(e){_4.setAttribute(_5,_6);}},_7=function(_8){return document.createElement(_8);},_9=common.utils.BrowerUtils;dojo.declare("drawboard.graphic.VMLGraphic",drawboard.graphic.Graphic,{anchor:null,createAnchor:function(w,h,_a){var _b=_7("div"),_c=["position:relative"];w&&_c.push("width:"+w);h&&_c.push("height:"+h);(_c.length>0)&&_1(_b,"style",_c.join(";"));this.anchor=_b;_a.appendChild(_b);return _b;},setSize:function(w,h){var _d=this.anchor,_e=[];w&&_e.push("width:"+w);h&&_e.push("height:"+h);(_e.length>0)&&_1(_d,"style",_e.join(";"));},drawPath:function(_f,_10,_11){var _12,d=[],ps;dojo.forEach(_f,function(_13){if(!_13){return;}if(typeof _13=="string"){this.push(_13);}else{this.push(_13.command);ps=_13.points;(!dojo.isArray(ps))&&(ps=[ps]);dojo.forEach(ps,function(p){this.push((p.x?(p.y?p.x+","+p.y:p.x):p.y)+" ");},this);}},d);!_11&&d.push(" x e");_10+=";width:1085;height:562;top:80;left:-40;position:absolute";_12=_7("<v:shape style='"+_10+"' coordorigin='0 0'></v:shape>");_1(_12,"path",d.join(""));this.anchor.appendChild(_12);return _12;},drawCircle:function(_14,r,_15){var s=["position:absolute","left:"+(_14.x-r),"top:"+(_14.y-r),"width:"+(r<<1),"height:"+(r<<1)],_16=_7("<v:oval style='"+s.join(";")+"'></v:oval>");this.anchor.appendChild(_16);return _16;},drawEllipse:function(_17,w,h,_18,_19){var s=["position:absolute","left:"+(_17.x-(w>>1)),"top:"+(_17.y-(h>>1)),"width:"+w,"height:"+h],_1a=_7("<v:oval style='"+s.join(";")+"'></v:oval>");this.anchor.appendChild(_1a);return _1a;},drawLine:function(p1,p2,_1b){var _1c=_7("<v:line style='position:absolute'><v:line>");_1(_1c,"from",p1.x+","+p1.y);_1(_1c,"to",p2.x+","+p2.y);this.anchor.appendChild(_1c);return _1c;},drawRect:function(_1d,w,h,rx,_1e,_1f){var s=["position:absolute","left:"+_1d.x,"top:"+_1d.y,"width:"+w,"height:"+h],_20=(rx===undefined)?_7("<v:Rect style="+s.join(";")+"></v:Rect>"):_7("<v:RoundRect style="+s.join(";")+"></v:RoundRect>");if(_1e){for(var _21 in _1e){_1(_20,_21,((_1e[_21] instanceof Array)?_1e[_21].join(" "):_1e[_21]));}}_1f&&_1(_20,"style",_1f);this.anchor.appendChild(_20);return _20;},drawImage:function(_22,w,h,url,_23){var s=["position:absolute","left:"+_22.x,"top:"+_22.y,"width:"+w,"height:"+h],_24=_7("<v:image src='../../"+url+"' style='"+s.join(";")+"' ></v:image>");this.anchor.appendChild(_24);return _24;},drawText:function(_25,w,h,_26,_27,_28){var _29=_7("text"),s=_28,_2a,_2b=_26&&_26.split("\n");x=_25&&_25.x+(w>>1),y=_25&&_25.y+(h>>1),unitHeight=_26&&_9.getFontHeight(_26,_28);x&&_1(_29,"x",x);y&&_1(_29,"y",y);_1(_29,"width",w);_1(_29,"height",h);if(_27){for(var _2c in _27){_1(_29,_2c,_27[_2c] instanceof Array?_27[_2c].join(" "):_27[_2c]);}}s&&(s.indexOf("text-anchor")==-1)&&(s+=";text-anchor:middle;");!s&&(s="text-anchor:middle;");s&&_1(_29,"style",s);_2b&&dojo.forEach(_2b,function(t,_2d){_2a=_7("tspan");_1(_2a,"x",x);_1(_2a,"y",y+unitHeight*_2d);_2a.textContent=t;_29.appendChild(_2a);},this);this.anchor.appendChild(_29);return _29;},clear:function(){var _2e=this.anchor;while(_2e.lastChild){_2e.removeChild(_2e.lastChild);}}});})();}