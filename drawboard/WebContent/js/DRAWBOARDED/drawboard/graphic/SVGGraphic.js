/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["drawboard.graphic.SVGGraphic"]){dojo._hasResource["drawboard.graphic.SVGGraphic"]=true;dojo.provide("drawboard.graphic.SVGGraphic");dojo.require("drawboard.graphic.Graphic");dojo.require("common.utils.BrowerUtils");(function(){var _1="http://www.w3.org/2000/svg",_2="http://www.w3.org/1999/xlink",_3=dojo.attr,_4=window.location.pathname,_5=_4.substring(0,_4.indexOf("/",1)+1),_6=function(_7,ns,_8,_9){_7.setAttributeNS?_7.setAttributeNS(ns,_8,_9):_7.setAttribute(_8,_9);},_a=function(_b){return document.createElementNS?document.createElementNS(_1,_b):document.createElement(_b);},_c=common.utils.BrowerUtils;dojo.declare("drawboard.graphic.SVGGraphic",drawboard.graphic.Graphic,{anchor:null,createAnchor:function(w,h,_d){var _e=_a("svg");w&&_3(_e,"width",w);h&&_3(_e,"height",h);this.anchor=_e;_d&&(_d.appendChild(_e));return _e;},setSize:function(w,h){var _f=this.anchor;w&&_3(_f,"width",w);h&&_3(_f,"height",h);},drawPath:function(_10,_11,_12){var _13=_a("path"),d=[],ps;dojo.forEach(_10,function(_14){if(!_14){return;}if(typeof _14=="string"){this.push(_14);}else{this.push(_14.command);ps=_14.points;(!dojo.isArray(ps))&&(ps=[ps]);dojo.forEach(ps,function(p){this.push((p.x?(p.y?p.x+","+p.y:p.x):p.y)+" ");},this);}},d);!_12&&d.push("Z");_3(_13,"d",d.join(""));_11&&_3(_13,"style",_11);this.anchor.appendChild(_13);return _13;},drawCircle:function(_15,r,_16){var _17=_a("circle");_3(_17,"cx",_15.x);_3(_17,"cy",_15.y);_3(_17,"r",r);_16&&_3(_17,"style",_16);this.anchor.appendChild(_17);return _17;},drawEllipse:function(_18,w,h,_19,_1a){var _1b=_a("ellipse"),w=(w>>1),h=(h>>1);_3(_1b,"cx",_18.x+w);_3(_1b,"cy",_18.y+h);_3(_1b,"rx",w);_3(_1b,"ry",h);_1a&&_3(_1b,"style",_1a);if(_19){for(var _1c in _19){_3(_1b,_1c,((_19[_1c] instanceof Array)?_19[_1c].join(" "):_19[_1c]));}}this.anchor.appendChild(_1b);return _1b;},drawLine:function(p1,p2,_1d){var _1e=_a("line");_3(_1e,"x1",p1.x);_3(_1e,"y1",p1.y);_3(_1e,"x2",p2.x);_3(_1e,"y2",p2.y);_1d&&_3(_1e,"style",_1d);this.anchor.appendChild(_1e);return _1e;},drawRect:function(_1f,w,h,rx,_20,_21){var _22=_a("rect");_3(_22,"x",_1f.x);_3(_22,"y",_1f.y);_3(_22,"width",w);_3(_22,"height",h);if(_20){for(var _23 in _20){_3(_22,_23,((_20[_23] instanceof Array)?_20[_23].join(" "):_20[_23]));}}(rx!==undefined&&rx!=null)&&(_3(_22,"rx",rx));_21&&_3(_22,"style",_21);this.anchor.appendChild(_22);return _22;},drawImage:function(_24,w,h,url,_25){var _26=_a("image");_24&&_3(_26,"x",_24.x);_24&&_3(_26,"y",_24.y);_3(_26,"width",w);_3(_26,"height",h);_6(_26,_2,"xlink:href",_5+url);if(_25){for(var _27 in _25){_3(_26,_27,_25[_27] instanceof Array?_25[_27].join(" "):_25[_27]);}}this.anchor.appendChild(_26);return _26;},drawText:function(_28,w,h,_29,_2a,_2b){var _2c=_a("text"),s=_2b,_2d,_2e=_29&&_29.split("\n");x=_28&&_28.x+(w>>1),y=_28&&_28.y+(h>>1),unitHeight=_29&&_c.getFontHeight(_29,_2b);x&&_3(_2c,"x",x);y&&_3(_2c,"y",y);_3(_2c,"width",w);_3(_2c,"height",h);if(_2a){for(var _2f in _2a){_3(_2c,_2f,_2a[_2f] instanceof Array?_2a[_2f].join(" "):_2a[_2f]);}}s&&(s.indexOf("text-anchor")==-1)&&(s+=";text-anchor:middle;");!s&&(s="text-anchor:middle;");s&&_3(_2c,"style",s);_2e&&dojo.forEach(_2e,function(t,_30){_2d=_a("tspan");_3(_2d,"x",x);_3(_2d,"y",y+unitHeight*_30);_2d.textContent=t;_2c.appendChild(_2d);},this);this.anchor.appendChild(_2c);return _2c;},clear:function(){var _31=this.anchor;while(_31.lastChild){_31.removeChild(_31.lastChild);}}});})();}